<!DOCTYPE html>




<html class="theme-next muse" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="一个铜板">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="一个铜板">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一个铜板">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>一个铜板</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一个铜板</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">把握今天,做有意义的事。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/05/Windows下安装MySQL步骤/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/05/Windows下安装MySQL步骤/" itemprop="url">Windows下安装MySQL步骤</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-05T21:04:11+08:00">
                2018-06-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/06/05/Windows下安装MySQL步骤/" class="leancloud_visitors" data-flag-title="Windows下安装MySQL步骤">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1: 下载zip安装包<br>2: 解压zip至目录D:\MySQL     此处假设安装目录是D:\MySQL<br>3: 在MySQL目录下新建my.ini配置文件内容如下<br>    [mysql]<br>    default-character-set=utf8<br>    [mysqld]</p>
<pre><code># The TCP/IP Port the MySQL Server will listen on
port=3306
# Path to installation directory. All paths are usually resolved relative to this.
# basedir=&quot;D:/MySQL/MySQL Server 5.7/&quot;
# 等同与basedir=&quot;D:\\MySQL\\MySQL Server 5.7\\&quot;

# Path to the database root
datadir=D:\\MySQL\\MySQL Server 5.7\\Data

# The default character set that will be used when a new schema or table is
# created and no character set is defined
character-set-server=utf8

# The default storage engine that will be used when create new tables when
default-storage-engine=INNODB
</code></pre><p>4:  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> D:\MySQL\MySQL Server 5.7\bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法一</span></span><br><span class="line">mysqld --initialize --console  <span class="comment"># 初始化data目录，并且输出日志至控制台其中包含随机密码</span></span><br><span class="line">mysqld install 服务名</span><br><span class="line">net start 服务名</span><br><span class="line">mysql -u root -p </span><br><span class="line">输入随机密码</span><br><span class="line">mysql&gt;alter user <span class="string">'root'</span>@<span class="string">'localhost'</span> identified by <span class="string">'新密码'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line">mysqld --initialize-insecure <span class="comment"># 初始化data目录，但是不创建随机密码</span></span><br><span class="line">mysqld install 服务名</span><br><span class="line">net start 服务名</span><br><span class="line">mysql -u root --skip-password</span><br><span class="line">mysql&gt;alter user <span class="string">'root'</span>@<span class="string">'localhost'</span> identified by <span class="string">'新密码'</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/20/How-to-run-ASP-NET-Core-Website-in-Production-On-Ubuntu-Linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/20/How-to-run-ASP-NET-Core-Website-in-Production-On-Ubuntu-Linux/" itemprop="url">How to run ASP.NET Core Website in Production On Ubuntu Linux</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-20T00:20:17+08:00">
                2018-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/04/20/How-to-run-ASP-NET-Core-Website-in-Production-On-Ubuntu-Linux/" class="leancloud_visitors" data-flag-title="How to run ASP.NET Core Website in Production On Ubuntu Linux">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>With the release of .NET Core and ASP.NET Core it’s now possible to run modern web applications written in C# on Linux. In this post, I will show you how to configure a Ubuntu server to run an ASP.NET Core site in production.</p>
<p>This post will cover:</p>
<p>What is ASP.NET Core?<br>How to install .NET Core on Ubuntu.<br>Running an ASP.NET Core website on Ubuntu.<br>Configure NGINX as a Reverse Proxy to ASP.NET Core.<br>Configure ASP.NET Core as a Background Service.<br>What is ASP.NET Core?<br>ASP.NET Core is a rewrite of ASP.NET and now runs on multiple operating systems such as Windows, OS X, Linux etc. Here is an excerpt of how the ASP.NET team describe it.</p>
<p>ASP.NET Core is a new open-source and cross-platform framework for building modern cloud based internet connected applications, such as web apps, IoT apps and mobile backends. ASP.NET Core apps can run on .NET Core or on the full .NET Framework. – Introduction to ASP.NET Core</p>
<p>I think it goes without saying the benefits this brings to the whole development community. Businesses that use Windows can save costs on server licenses by running their apps on Linux.</p>
<p>How to Install .NET Core on Ubuntu<br>In order to run ASP.NET Core on Linux we need to install .NET Core. Follow the steps below to install .NET Core on your required Ubuntu version.</p>
<p>Install ASP.NET Core on Ubuntu 14.04</p>
<p>sudo sh -c ‘echo “deb [arch=amd64] <a href="https://apt-mo.trafficmanager.net/repos/dotnet/" target="_blank" rel="noopener">https://apt-mo.trafficmanager.net/repos/dotnet/</a> trusty main” &gt; /etc/apt/sources.list.d/dotnetdev.list’<br>sudo apt-key adv –keyserver apt-mo.trafficmanager.net –recv-keys 417A0893<br>sudo apt-get update<br>sudo apt-get install dotnet-dev-1.0.0-preview2-003121<br>Install ASP.NET Core on Ubuntu 16.04</p>
<p>sudo sh -c ‘echo “deb [arch=amd64] <a href="https://apt-mo.trafficmanager.net/repos/dotnet/" target="_blank" rel="noopener">https://apt-mo.trafficmanager.net/repos/dotnet/</a> xenial main” &gt; /etc/apt/sources.list.d/dotnetdev.list’<br>sudo apt-key adv –keyserver apt-mo.trafficmanager.net –recv-keys 417A0893<br>sudo apt-get update<br>sudo apt-get install dotnet-dev-1.0.0-preview2-003121<br>Running an ASP.NET Core Website on Ubuntu<br>The first step is to prepare the output directory that our test project will be published to.</p>
<p>sudo mkdir -p /srv/aspnet/hellomvc.com<br>sudo chown -R :www-data /srv/aspnet<br>sudo chmod -R g+s /srv/aspnet<br>The first command creates the directory, the second command changes the group to www-data and the last command makes sure that new files and folders inside the directory will be assigned the www-data group on creation. The reason we assign www-data to the directory is because it is safer to run the app as the www-data user.</p>
<p>Next we will download the samples from the ASP.NET GitHub repository and then publish the sample application to our output directory.</p>
<p>git clone <a href="https://github.com/aspnet/cli-samples" target="_blank" rel="noopener">https://github.com/aspnet/cli-samples</a> /tmp/samples<br>cd /tmp/samples/HelloMvc<br>dotnet restore<br>sudo dotnet publish -c Release -o /srv/aspnet/hellomvc.com<br>Test running the application as the www-data user with the following command:</p>
<p>sudo -u www-data bash -c “dotnet /srv/aspnet/hellomvc.com/HelloMvc.dll”<br>You should see the output</p>
<p>ASP.NET Core Started Image</p>
<p>Press Ctrl+C to shutdown the application.</p>
<p>Configure NGINX as a Reverse Proxy to ASP.NET Core<br>As you may have noticed when we tested the ASP.NET Core app in the previous section, the port it was listening on was 5000. We could change the app to listen on port 80 but that would mean no other sites on the server would be able to run at the same time. It’s also not recommended by Microsoft to run Kestrel (the ASP.NET Core module that handles HTTP requests) without a proxy.</p>
<p>To get around this we need to configure NGINX to listen on port 80 and proxy the requests to our ASP.NET Core app.</p>
<p>First we need to install NGINX with the following command.</p>
<p>sudo apt-get install nginx<br>Now we need to create the virtual host config for our test app by creating a new file called hellomvc.com.conf in the /etc/nginx/sites-available directory.</p>
<p>sudo vim /etc/nginx/sites-available/hellomvc.com.conf<br>Add the following configuration options to the file.</p>
<p>server {<br>    listen 80;<br>    server_name hellomvc.com;</p>
<pre><code>location / {
    proxy_pass http://127.0.0.1:5000;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection keep-alive;
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
}
</code></pre><p>}<br>Activate the new virtual host.</p>
<p>sudo ln -s /etc/nginx/sites-available/hellomvc.com.conf /etc/nginx/sites-enabled/<br>Apply the configuration.</p>
<p>sudo nginx -s reload<br>After running the command we used above to start the app again, you should be able to access the site at <a href="http://hellomvc.com" target="_blank" rel="noopener">http://hellomvc.com</a>.</p>
<p>However, manually starting the process in production is not desirable, so we will configure the app to run as a background service in the next step.</p>
<p>Configure ASP.NET Core as a Background Service<br>Supervisor is a third-party program that can be used to monitor a process on Linux. By installing and configuring Supervisor we can monitor the ASP.NET Core process, so that it starts with the operating system and restarts in the event of a failure.</p>
<p>Install Supervisor with the following command.</p>
<p>sudo apt-get install supervisor<br>The permissions of the supervisor.sock file need changed so that programs can be restarted without using sudo. Edit the supervisord.conf file.</p>
<p>sudo vim /etc/supervisor/supervisord.conf<br>Change chmod from 700 to 766.</p>
<p>[unix_http_server]<br>file=/var/run/supervisor.sock   ; (the path to the socket file)<br>chmod=0766                      ; socket file mode (default 0700)<br>Start Supervisor.</p>
<p>sudo service supervisor start<br>Configure Supervisor to monitor our ASP.NET Core app</p>
<p>sudo vim /etc/supervisor/conf.d/aspnet.conf<br>Add contents and save.</p>
<p>[group:hellomvc]<br>programs=hellomvcapp</p>
<p>[program:hellomvcapp]<br>directory=/srv/aspnet/hellomvc.com<br>command=/usr/bin/dotnet HelloMvc.dll<br>autostart=true<br>autorestart=true<br>stderr_logfile=/var/log/hellomvc.err.log<br>stdout_logfile=/var/log/hellomvc.out.log<br>user=www-data<br>stopsignal=INT<br>stopasgroup=true<br>Restart Supervisor to apply the changes.</p>
<p>sudo service supervisor restart<br>The application can now be started with.</p>
<p>supervisorctl start hellomvc:<br>You should be able to view the site by browsing to: <a href="http://hellomvc.com" target="_blank" rel="noopener">http://hellomvc.com</a>. Note: You will need to add hellomvc.com to your DNS server or hosts file to test the app.</p>
<p>If you are using Windows I have created handy tool that makes editing the hosts file easy. You can download it from GitHub here or read more about it in this post: Announcing Hosts Editor, a FREE tool for editing the Windows hosts file.</p>
<p>You can check for startup errors at /var/log/hellomvc.err.log and runtime logging at /var/log/hellomvc.out.log.</p>
<p>Final Thoughts<br>After following the steps in this post, you should now be able to configure Ubuntu server to host your ASP.NET Core websites. I’m using a similar setup to run this website and I’m finding it fast and deploying to it is easy with Git.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/25/软件开发两个基本原则/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/25/软件开发两个基本原则/" itemprop="url">软件开发两个基本原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-25T20:19:16+08:00">
                2018-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/02/25/软件开发两个基本原则/" class="leancloud_visitors" data-flag-title="软件开发两个基本原则">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>YAGNI</strong> - You are not gonna need it<br>缩短开发时间</p>
<p><strong>KISS</strong> - Keep it short and simple<br>编写可维护代码</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/29/N层架构/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/29/N层架构/" itemprop="url">N层架构</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-29T16:07:56+08:00">
                2018-01-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/01/29/N层架构/" class="leancloud_visitors" data-flag-title="N层架构">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>应用程序基于代码结构分层是一个被广泛接受的技巧用爱帮助降低复杂性并且提高代码的重用性。为了达到这一目标，ABP采用基于DDD的原则。</p>
<p>在DDD中有四个基础层</p>
<ul>
<li><strong>呈现层(Presentation Layer)</strong>:提供用户交互的入口，通过<code>Application Layer</code>与之交互。</li>
<li><strong>应用层(Application Layer)</strong>:协调呈现层和领域层。组织业务逻辑对象来执行应用任务。</li>
<li><strong>领域层(Domain Layer)</strong>:包含业务对象和规则，这是应用的核心层。</li>
<li><strong>基础设施层(Infrastructure Layer)</strong>:大多数使用第三库为其他层提供通用的技术。</li>
</ul>
<p>ABP应用架构模型<br>DDD之外，在现代应用架构中还有其他的逻辑和物理层。下面是ABP推崇并实现的架构模型，ABP不仅提供了基类和服务方便实现此模型同时可以直接使用启动模板(<code>startup templates</code>)基于此模型开发。<br><img src="/images/abp-nlayer-architecture.png" title="abp-nlayer-architecture"></p>
<p>Client Application<br>通过HTTP APIs(Controller也许是GrphQL endpoint)作为服务来使用应用的远程客户端。远程客户端可以是SPA,APP,或者是第三方消费者。本地化和导航可以在应用本身完成。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/29/ABP中文文档/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/29/ABP中文文档/" itemprop="url">ABP中文文档</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-29T13:17:58+08:00">
                2018-01-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/01/29/ABP中文文档/" class="leancloud_visitors" data-flag-title="ABP中文文档">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本篇是ABP中文文档系列的第一篇，之所以开始翻译ABP文档一是提高自己对于框架本身的理解，二是方便大家不用啃英文，快速对框架有一个基本的认识，当然翻译再所难免有理解偏差，有不同见解的同学可以在文章后面评论，若大家都认同我会在后面对其进行更正，谢谢大家，下面开始主题。</p>
</blockquote>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>不同的应用都是基于不同的需求进行创建的。在某种程度上，我们会反复的实现类似功能模块，比喻授权、验证、异常处理、日志、本地化、数据库连接管理、设置管理和审计日志这些公共的模块。我们总是在构建体系结构和最佳实践比喻分层和模块化架构，领域驱动设计，依赖注入和其他等等，也会基于约定来开发这些应用。</p>
<p>然而所有这些都是耗时并且很难为每一个项目分离构建，很多公司创建自己的私有框架。使用这些框架，他们可以更高效并且较少bug。但是不是所有公司都如此lucky。大多数没有时间和预算和团队去开发这样的框架。即使他们有这样的能力做这件事，也很难形成规范的文档，方便其他开发者快速学习，还要去维护迭代。</p>
<p>ABP是一个开源并且拥有良好文档的应用程序框架，初心是开发一个所有公司和开发者都能获益的公共框架，然而他又不仅仅是一个框架，同时也提供一个健壮的基于领域驱动设计的架构模型和很多最佳实践。</p>
<h2 id="一个简单的实例"><a href="#一个简单的实例" class="headerlink" title="一个简单的实例"></a>一个简单的实例</h2><p>让我们浏览一个类看看ABP带来的益处<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class TaskAppService:ApplicationService,ITaskAppService</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IRepository&lt;Task&gt; _taskRepository;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TaskAppService</span>(<span class="params">IRepository&lt;Task&gt; taskRepository</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _taskRepository=taskRepository;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">AbpAuthorize(MyPermissions.UpdateTasks)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">UpdateTask</span>(<span class="params">UpdateTaskInput input</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Logger.Info(<span class="string">"updateing a task for input:"</span> + input);</span><br><span class="line">        <span class="keyword">var</span> task=<span class="keyword">await</span> _taskRepository.FirstOrDefaultAsync(input.TaskId);</span><br><span class="line">        <span class="keyword">if</span>(task==<span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UserFriendlyException(L(<span class="string">"CouldNotFindTheTaskMessage"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        input.MapTo(task);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这是一个简单的<code>application Service</code>方法。在DDD中<code>application service</code>是直接被呈现层作为应用用例执行。本例中的<code>UpdateTask</code>将被前端js通过AJAX调用</p>
<p>让我们看看ABP拥有的特性或者是益处：</p>
<ul>
<li>Dependency Injection:ABP使用并且提供一个强大的基于约定的DI基础设施。如果一个类是<code>application service</code>,按照约定会作为短暂对象（每个请求重新创建）自动注册到DI容器中。可以简单的注入任何依赖，比喻此实例中的<code>IRepository&lt;Task&gt;</code>。</li>
<li>Repository:ABP为每个实体(entity)创建默认的仓储，此实例中<code>IRepository&lt;Task&gt;</code>,其中<code>Task</code>为实体对象。默认的仓储有许多有用的方法如<code>FirstOrDefault</code>。可以很容易根据自己的需求扩展默认仓储。仓储抽象关系型数据库与ORMs框架简化数据访问逻辑。</li>
<li>Authorization:ABP可以检查权限。如果当前用户没有<code>update tasks</code>权限或者没有登录，将被阻止访问<code>UpdateTask</code>方法。ABP不仅可以使用声明特性，同时也提供其他的方式让你使用授权特性。</li>
<li>Validation:ABP自动检查输入是否为空对象。他可以基于<code>data annotation</code>特性和个性化验证规则验证所有输入属性的合法性。假如请求不合法，他将抛出合适的验证异常。</li>
<li>AuditLogging:基于配置和约定用户、浏览器、IP地址、调用服务方法以及参数、调用时间、执行时长等等这些信息会自动保存。</li>
<li>Unit Of Work:在ABP中每个<code>application service</code>方法默认都被假定为一个unit of work，他会自动创建一个连接同时在方法的开始创建事务。如果方法执行没有异常抛出成功完成，事务将在连接释放时提交，即使方法中包含不同的仓储或者其他的方法，所有这些都是原子的。所有对实体对象的变更都将在事务提交后保存，连<code>_repository.Update(task)</code>方法都不用调用。</li>
<li>Exception Handling:web应用程序中我们都不用手动处理异常。所有异常默认都被自动处理，ABP自动记录他并且返回一个合适的结果给客户端。举例一个ajax请求，他返回一个json对象给客户端表示错误发生。如果异常是个用户友好异常将对客户端隐藏真实的异常，就像本实例中处理task==null的情况。</li>
<li>Logging:正如你所看到的我们在实例中使用Logger对象。默认使用Log4Net日志组件，当然你也可以更换或者配置它。</li>
<li>Localization:不知道你注意到我们抛出用户友好异常时使用<code>L</code>方法，这个方法根据用户当前的culture自动实现本地化，我们在其他地方定义<code>CouldNotFindTheTaskMessage</code>内容。</li>
<li>Auto Mapping:本实例中最后一行我们使用了MapTo扩展方法映射输入属性到实体属性。使用了AutoMapper库执行映射。我们可以很容易根据命名约定映射属性。</li>
<li>Dynamic Web API Layer:TaskAppService 是一个简单的类，现实中我们一般还要包装将其包装成一个WebAPI控制器对javascript客户端提供方法调用，然而ABP框架已经在运行时自动为你做了。</li>
<li>Dynamic Javascript AJAX Proxy:ABP创建了代理方法让你在客户端想调用javascript方法一样调用应用服务。</li>
</ul>
<h2 id="其他的特性"><a href="#其他的特性" class="headerlink" title="其他的特性"></a>其他的特性</h2><ul>
<li>Modularity:提供了一个强大的基础设施构建可重用的模块。</li>
<li>Data Filters:自动数据过滤实现了一些模式如软删除和多租户。</li>
<li>Multi Tenancy:完全支持多租户，包括单个数据库或者每个租户一个数据库的结构。</li>
<li>Setting Management:提供了一个强大的基础设施更改和获取应用，租户和用户级别的设置。</li>
<li>Unit &amp; Integration Testing:ABP也是考虑到可测试性构建的。它提供了一些基础类来简化单元和整合测试。</li>
</ul>
<p>下一篇：<a href="/2018/01/29/N层架构/" title="N层架构">N层架构</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/C-委托以及事件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/C-委托以及事件/" itemprop="url">C#委托以及事件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T16:59:35+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/01/27/C-委托以及事件/" class="leancloud_visitors" data-flag-title="C#委托以及事件">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>相关知识点概要<br><code>C指针</code>、<code>匿名方法</code>、<code>lambda表达式</code></p>
<h4 id="C-委托定义"><a href="#C-委托定义" class="headerlink" title="C#委托定义"></a>C#委托定义</h4><p>委托是持有一个或多个方法的对象</p>
</blockquote>
<p>与其他对象不同的是委托可以被执行，这时委托会执行它所持有的方法,下面是一个简单的委托实例<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">xxx</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">delegate</span> <span class="keyword">void</span> <span class="title">MyDel</span>(<span class="params"><span class="keyword">int</span> x</span>)</span>;<span class="comment">//声明委托类型,不能省略形参名称x</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">PrintHigh</span>(<span class="params"><span class="keyword">int</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$"<span class="subst">&#123;<span class="keyword">value</span>&#125;</span> - High Value"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">PrintLow</span>(<span class="params"><span class="keyword">int</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$"<span class="subst">&#123;<span class="keyword">value</span>&#125;</span> - Low Value"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Program main=<span class="keyword">new</span> Program();</span><br><span class="line">            MyDel del;<span class="comment">//声明委托变量</span></span><br><span class="line">            Random rand=<span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> randomValue=rand.Next(<span class="number">99</span>);</span><br><span class="line">            del=randomValue&gt;<span class="number">50</span>?<span class="keyword">new</span> MyDel(main.PrintHigh):<span class="keyword">new</span> MyDel(main.PrintLow);</span><br><span class="line">            del(randomValue);<span class="comment">//执行委托</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;你可以把委托看成一个包含有序方法列表的对象，这些方法具有相同的签名和返回类型（本例中的<code>PrintHigh</code>和<code>PrintLow</code>），方法可以来自任何类和结构，<font color="blue">可以是静态方法也可以是实例方法</font>，只要签名和返回类型和委托声明匹配。</p>
<p>以下创建了委托变量并初始化，两种方法是等同的</p>
<ol>
<li><code>MyDel delVar1=new MyDel(obj.Method);</code></li>
<li><code>MyDel delVar2=obj.Method;</code></li>
</ol>
<p>相同类型的委托可以使用+组合，如MyDel del=delVar1+delVar2,如果调用del将执行两次obj.Method方法，也可以通过为委托增加方法达到同样的效果<code>delVar1+=obj.Method</code>,此处需要注意的是调用列表中即使存在同样的方法也可以增加，结果是同一个方法可以调用多次</p>
<p>以上委托实例返回值是void，如果委托类型带有返回值，当委托变量包含多个方法时执行委托的结果是最后一个方法的返回值，其他方法的返回值均被丢弃。</p>
<p>带引用参数的委托，参数值会随着调用列表中方法的调用而改变</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/26/使用Docker构建AspNetCore应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/26/使用Docker构建AspNetCore应用/" itemprop="url">使用Docker构建AspNetCore应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-26T20:47:57+08:00">
                2018-01-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/01/26/使用Docker构建AspNetCore应用/" class="leancloud_visitors" data-flag-title="使用Docker构建AspNetCore应用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Build Image Stage</span></span><br><span class="line">FROM microsoft/aspnetcore-build:2 AS build-env</span><br><span class="line">WORKDIR /api</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下为优化还原，因为项目文件不常变动Docker在构建过程可以使用Cache</span></span><br><span class="line">COPY api.csproj .</span><br><span class="line">RUN dotnet restore</span><br><span class="line"></span><br><span class="line">COPY . .</span><br><span class="line">RUN dotnet publish -o /publish</span><br><span class="line"></span><br><span class="line"><span class="comment">#Runtime Image Stage</span></span><br><span class="line">FROM microsoft/aspnetcore:2</span><br><span class="line">WORKDIR /publish</span><br><span class="line">COPY --from=build-env /publish .</span><br><span class="line">EXPOSE 80</span><br><span class="line">ENTRYPOINT [<span class="string">"dotnet"</span>,<span class="string">"api.dll"</span>]</span><br></pre></td></tr></table></figure>
<p>备注：api.dll是发布后的入口文件（项目名api)<br>建议和提醒：一般同学都使用Docker for Windows，Windows 10之前的版本只能使用Docker Toolbox,Docker 也只支持 Windows 10特定版本同时需要开启Hyper-V</p>
<p>建议使用Linux Container 这样的话官网镜像会小很多（Docker for Windows 分Linux Container 和Windows Container可以通过右击Docker图标弹出的上下文菜单切换），也可以是用Docker加速器</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/26/markdown-语法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="derily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个铜板">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/26/markdown-语法/" itemprop="url">markdown 语法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-26T11:39:54+08:00">
                2018-01-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/01/26/markdown-语法/" class="leancloud_visitors" data-flag-title="markdown 语法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Headings-标题<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line"># The largest heading</span><br><span class="line">## The second largest heading</span><br><span class="line">###### The smallest heading</span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="The-largest-heading"><a href="#The-largest-heading" class="headerlink" title="The largest heading"></a>The largest heading</h1><h2 id="The-second-largest-heading"><a href="#The-second-largest-heading" class="headerlink" title="The second largest heading"></a>The second largest heading</h2><h6 id="The-smallest-heading"><a href="#The-smallest-heading" class="headerlink" title="The smallest heading"></a>The smallest heading</h6><p>Styling text-文本样式<br><strong>加粗文本</strong> **内容** 或者 __内容__</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/01/26/markdown-语法/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">derily</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/derily" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:click.world@hotmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://macshou.com/" title="MacTalk" target="_blank">MacTalk</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ruanyifeng.com" title="阮一峰的网络日志" target="_blank">阮一峰的网络日志</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">derily</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("bDBCQpugsS3h1RiEac5QCVo6-gzGzoHsz", "L5HNxjf2RqmYNOA6IlrvtrVr");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
